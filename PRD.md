# FlowForge - Product Requirements Document

## Overview

FlowForge is a **neurodivergent-friendly time tracking and invoicing application** for freelancers. Built with Tauri + React for cross-platform desktop support (macOS, Windows, Linux).

---

## Core Features

### 1. Timer System

**Main Timer View**
- Large time display (HH:MM:SS)
- Status indicator: Ready (gray), Tracking (green), Paused (orange)
- Project selector dropdown (only active projects)
- Start/Pause/Resume/Stop buttons
- Current project name shown when running

**Floating Timer Widget**
- Always-on-top mini window (Tauri window)
- Shows elapsed time + project name
- Pause/Resume/Stop buttons
- Draggable, position persisted
- Toggle via settings or keyboard shortcut

**Timer Behavior**
- Pause accumulates `pauseDuration`
- Stop creates a TimeEntry record
- Active timer restored on app restart

---

### 2. Clients

**Data Model: Client**
| Field | Type | Required |
|-------|------|----------|
| id | UUID | Yes |
| name | string | Yes |
| email | string | No |
| address | string | No |
| phone | string | No |
| hourlyRate | number | No (default 0) |
| notes | string | No |
| createdAt | ISO date | Yes |
| updatedAt | ISO date | Yes |

**UI Requirements**
- List view with search
- Create/Edit form (modal or page)
- Delete with confirmation
- Show total hours and billable amount per client

---

### 3. Projects

**Data Model: Project**
| Field | Type | Required |
|-------|------|----------|
| id | UUID | Yes |
| clientId | UUID | No (FK to clients) |
| name | string | Yes |
| description | string | No |
| status | enum | Yes (active/paused/completed) |
| color | hex string | Yes (default #007AFF) |
| createdAt | ISO date | Yes |
| updatedAt | ISO date | Yes |

**UI Requirements**
- List with color indicators and status badges
- Filter by status
- Create/Edit form
- Show associated client name
- Show total tracked time

---

### 4. Time Entries

**Data Model: TimeEntry**
| Field | Type | Required |
|-------|------|----------|
| id | UUID | Yes |
| projectId | UUID | Yes (FK to projects) |
| startTime | ISO datetime | Yes |
| endTime | ISO datetime | No (null if running) |
| pauseDuration | number (seconds) | Yes (default 0) |
| notes | string | No |
| isBillable | boolean | Yes (default true) |
| isBilled | boolean | Yes (default false) |
| createdAt | ISO date | Yes |

**Computed Values**
- `duration` = (endTime - startTime) - pauseDuration
- `totalHours` = duration / 3600

**UI Requirements**
- List view with pagination/virtual scroll
- Filter by: date range, project, client, billable status
- Inline editing for notes
- Bulk actions: delete, mark as billed

---

### 5. Invoices

**Data Model: Invoice**
| Field | Type | Required |
|-------|------|----------|
| id | UUID | Yes |
| clientId | UUID | Yes (FK to clients) |
| invoiceNumber | string | Yes (e.g., INV-2026-0001) |
| issueDate | ISO date | Yes |
| dueDate | ISO date | Yes |
| status | enum | Yes (draft/sent/paid/overdue/cancelled) |
| notes | string | No |
| taxRate | number | Yes (default 0, e.g., 0.20 for 20%) |
| createdAt | ISO date | Yes |
| updatedAt | ISO date | Yes |

**Data Model: InvoiceLineItem**
| Field | Type | Required |
|-------|------|----------|
| id | UUID | Yes |
| invoiceId | UUID | Yes (FK to invoices) |
| description | string | Yes |
| quantity | number | Yes |
| unitPrice | number | Yes |

**UI Requirements**
- List with status filter and search
- Create invoice flow:
  1. Select client
  2. Choose projects â†’ import unbilled hours
  3. Add/edit line items
  4. Set dates, notes, tax rate
- Invoice preview (matches PDF style)
- Export to PDF

**PDF Export Must Include**
- Business logo (from settings)
- Business name, address, email, phone
- "INVOICE" header with invoice number
- Client billing info
- Issue date and due date
- Line items table
- Subtotal, tax, total
- Payment terms
- Footer: "Generated by FlowForge"

---

### 6. Settings

**General Tab**
- Show floating timer widget (toggle)
- Enable timer notifications (toggle)
- Sound feedback for actions (toggle)

**Appearance Tab**
- Theme: Light / Dark / System
- Font Size: Small (0.85x) / Medium (1x) / Large (1.15x) / Extra Large (1.3x)
  - **MUST scale ALL text in the entire app**
- Density: Compact / Comfortable / Spacious

**Accessibility Tab**
- Animation preference: Enabled / Disabled / Follow System
- Info section about neurodivergent-friendly design

**Business Tab**
- Business Name
- Business Address (textarea)
- Business Email
- Business Phone
- Logo Upload (stored locally)
- Default Tax Rate (percentage input)
- Payment Terms (textarea)

---

## Database Schema (SQLite)

```sql
CREATE TABLE IF NOT EXISTS clients (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  email TEXT DEFAULT '',
  address TEXT DEFAULT '',
  phone TEXT DEFAULT '',
  hourly_rate REAL DEFAULT 0,
  notes TEXT DEFAULT '',
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS projects (
  id TEXT PRIMARY KEY,
  client_id TEXT REFERENCES clients(id) ON DELETE SET NULL,
  name TEXT NOT NULL,
  description TEXT DEFAULT '',
  status TEXT DEFAULT 'active',
  color TEXT DEFAULT '#007AFF',
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS time_entries (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
  start_time TEXT NOT NULL,
  end_time TEXT,
  pause_duration INTEGER DEFAULT 0,
  notes TEXT DEFAULT '',
  is_billable INTEGER DEFAULT 1,
  is_billed INTEGER DEFAULT 0,
  created_at TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS invoices (
  id TEXT PRIMARY KEY,
  client_id TEXT NOT NULL REFERENCES clients(id) ON DELETE CASCADE,
  invoice_number TEXT NOT NULL UNIQUE,
  issue_date TEXT NOT NULL,
  due_date TEXT NOT NULL,
  status TEXT DEFAULT 'draft',
  notes TEXT DEFAULT '',
  tax_rate REAL DEFAULT 0,
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS invoice_line_items (
  id TEXT PRIMARY KEY,
  invoice_id TEXT NOT NULL REFERENCES invoices(id) ON DELETE CASCADE,
  description TEXT NOT NULL,
  quantity REAL NOT NULL,
  unit_price REAL NOT NULL
);

CREATE TABLE IF NOT EXISTS settings (
  key TEXT PRIMARY KEY,
  value TEXT NOT NULL
);
```

---

## Tech Stack

- **Tauri 2** - Desktop runtime
- **React 18** - UI framework
- **TypeScript** - Type safety
- **TailwindCSS** - Styling
- **Zustand** - State management
- **SQLite** - Database (via tauri-plugin-sql)
- **jspdf** - PDF generation
- **Lucide** - Icons
- **React Router** - Navigation
